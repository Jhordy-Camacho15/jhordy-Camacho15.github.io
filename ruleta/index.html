<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruleta de Descuentos</title>
    <style>
        body {
            background: #f7f7f7;
            font-family: 'Segoe UI', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        .ruleta-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin-bottom: 40px;
        }
        .flecha {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 40px solid #e74c3c;
			transform: rotate(180deg);
        }
        #ruleta {
            width: 100%;
            height: 100%;
        }
        .boton-girar {
            padding: 15px 40px;
            font-size: 1.2em;
            background: #27ae60;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: background 0.2s;
        }
        .boton-girar:hover {
            background: #219150;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: #fff;
            padding: 30px 40px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.3em;
            box-shadow: 0 4px 24px rgba(0,0,0,0.2);
        }
        .modal-content button {
            margin-top: 20px;
            padding: 10px 30px;
            font-size: 1em;
            background: #e74c3c;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        .modal-content button:hover {
            background: #c0392b;
        }
    </style>
</head>
<body>
    <h1>¡Gira la Ruleta y Gana un Descuento!</h1>
    <div class="ruleta-container">
        <div class="flecha"></div>
        <canvas id="ruleta" width="400" height="400"></canvas>
    </div>
    <button class="boton-girar" id="girarBtn">Girar</button>

    <div class="modal" id="modal">
        <div class="modal-content" id="modalContent">
            <span id="premioTexto"></span><br>
            <button onclick="cerrarModal()">Cerrar</button>
        </div>
    </div>

    <script>
        const descuentos = [
            "5% de descuento",
            "10% de descuento",
            "15% de descuento",
            "20% de descuento",
            "25% de descuento",
            "30% de descuento",
            "35% de descuento",
            "40% de descuento",
            "45% de descuento",
            "50% de descuento",
            "¡Producto gratis!",
            "2x1 en tu compra"
        ];
        const colores = [
            "#f1c40f", "#e67e22", "#e74c3c", "#9b59b6", "#3498db", "#1abc9c", "#2ecc71", "#34495e", "#95a5a6", "#d35400", "#7f8c8d", "#16a085"
        ];
        const ruleta = document.getElementById('ruleta');
        const ctx = ruleta.getContext('2d');
        const partes = descuentos.length;
        let anguloActual = 0;
        let girando = false;

        function dibujarRuleta() {
            const radio = 200;
            const centroX = 200;
            const centroY = 200;
            ctx.clearRect(0, 0, 400, 400);
            for (let i = 0; i < partes; i++) {
                const angInicio = anguloActual + i * 2 * Math.PI / partes;
                const angFin = anguloActual + (i + 1) * 2 * Math.PI / partes;
                ctx.beginPath();
                ctx.moveTo(centroX, centroY);
                ctx.arc(centroX, centroY, radio, angInicio, angFin);
                ctx.closePath();
                ctx.fillStyle = colores[i % colores.length];
                ctx.fill();
                ctx.save();
                ctx.translate(centroX, centroY);
                ctx.rotate(angInicio + (angFin - angInicio) / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "#fff";
                ctx.font = "bold 18px Segoe UI";
                ctx.fillText(descuentos[i], radio - 10, 10);
                ctx.restore();
            }
        }

        dibujarRuleta();

        document.getElementById('girarBtn').addEventListener('click', function() {
            if (girando) return;
            girando = true;
            let tiempoGiro = Math.random() * 3 + 3; // 3 a 6 segundos
            let inicio = null;
            let velocidad = Math.random() * 0.15 + 0.25; // velocidad inicial
            let desaceleracion = velocidad / (tiempoGiro * 60); // frames

            function animarRuleta(timestamp) {
                if (!inicio) inicio = timestamp;
                if (velocidad > 0.01) {
                    anguloActual += velocidad;
                    velocidad -= desaceleracion;
                    dibujarRuleta();
                    requestAnimationFrame(animarRuleta);
                } else {
                    girando = false;
                    anguloActual = anguloActual % (2 * Math.PI);
                    dibujarRuleta();
                    mostrarPremio();
                }
            }
            requestAnimationFrame(animarRuleta);
        });

        function mostrarPremio() {
            // La flecha apunta hacia arriba (0 radianes)
            let anguloFlecha = (3 * Math.PI / 2 - anguloActual + 2 * Math.PI) % (2 * Math.PI);
            let indice = Math.floor(anguloFlecha / (2 * Math.PI / partes));
            let premio = descuentos[indice];
            document.getElementById('premioTexto').textContent = `¡Felicidades! Has ganado: ${premio}`;
            document.getElementById('modal').style.display = 'flex';
        }

        function cerrarModal() {
            document.getElementById('modal').style.display = 'none';
        }
        window.cerrarModal = cerrarModal;
    </script>
</body>
</html>